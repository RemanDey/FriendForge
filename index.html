<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FriendForge - Add/Edit Friend</title>
    <link rel="icon" href="icon.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Universal Box Sizing */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        /* General Body Styling - Modern Dark Mode */
        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif; /* Modern, clean font stack */
            background-color: #121212; /* Deeper, more sophisticated dark background */
            color: #E0E0E0; /* Soft white for primary text */
            margin: 0;
            padding: 20px 15px; /* More responsive padding for smaller screens */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            line-height: 1.6;
            text-rendering: optimizeLegibility; /* Improve text rendering */
        }

        /* Container for the entire app - Modern Dark Mode */
        .container {
            width: 100%; /* Default to full width minus padding */
            max-width: 768px; /* Limit max width for tablets/desktops */
            background-color: #1F1F1F; /* Darker charcoal for container */
            border-radius: 15px; /* More rounded corners */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); /* More pronounced, softer shadow */
            padding: 25px 20px; /* Adjusted padding for responsiveness */
            box-sizing: border-box;
            margin-bottom: 30px;
            border: 1px solid rgba(60, 60, 60, 0.8); /* Subtle border for definition */
            transition: all 0.3s ease-in-out; /* Smooth transition for hover effects */
        }

        .container:hover {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7); /* Deeper shadow on hover */
            transform: translateY(-3px); /* Slight lift on hover */
        }

        /* Navigation Styling - Modern Dark Mode */
        nav {
            display: flex;
            flex-direction: column; /* Stack navigation links in portrait by default */
            justify-content: center;
            gap: 15px; /* Adjust gap for stacking */
            margin-bottom: 30px; /* More separation from content */
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(70, 70, 70, 0.6);
        }

        nav a {
            text-decoration: none;
            color: #81D4FA;
            padding: 10px 20px; /* Smaller padding for stacked links */
            border-radius: 8px;
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            font-weight: 600;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center; /* Center text and icon in stacked mode */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            white-space: nowrap; /* Prevent text wrapping */
        }

        nav a i {
            margin-right: 8px; /* Slightly less space for icons */
            font-size: 1.1em;
        }

        nav a:hover {
            background-color: #00838F;
            color: #FFFFFF;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        nav a.active {
            background-color: #00ACC1;
            color: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        /* Main Heading - Modern Dark Mode */
        .main-title-link {
            text-decoration: none;
            color: inherit;
            display: block;
            text-align: center;
        }

        h1 {
            text-align: center;
            color: #B3E5FC;
            margin-bottom: 25px; /* Reduced margin */
            font-size: 2.5em; /* Slightly smaller for mobile first */
            font-weight: 700;
            letter-spacing: 0.05em;
            text-shadow: 0 2px 8px rgba(0, 172, 193, 0.4);
            border-bottom: 2px solid #00ACC1;
            padding-bottom: 15px; /* Reduced padding */
            transition: all 0.3s ease-in-out;
        }

        h1:hover {
            color: #E0F7FA;
            text-shadow: 0 3px 12px rgba(0, 172, 193, 0.7);
            transform: translateY(-2px);
        }

        /* Section Headings - Modern Dark Mode */
        .input-section h2, .display-section h2 {
            color: #81D4FA;
            margin-top: 0;
            margin-bottom: 20px; /* Reduced margin */
            border-bottom: 1px solid #00838F;
            padding-bottom: 10px; /* Reduced padding */
            font-size: 1.8em; /* Adjusted for smaller screens */
            font-weight: 600;
            text-align: center;
        }

        /* Form Styling */
        form {
            display: flex;
            flex-direction: column;
            gap: 15px; /* Reduced gap */
            padding: 20px; /* Reduced padding */
            border: 1px solid rgba(0, 172, 193, 0.4);
            border-radius: 12px;
            background-color: #282828;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.4); /* Reduced shadow */
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 5px; /* Reduced margin */
            font-weight: bold;
            color: #B3E5FC;
            font-size: 1em; /* Adjusted font size */
        }

        .form-group input[type="text"],
        .form-group input[type="date"], /* Added date input type */
        .form-group textarea {
            padding: 10px 12px; /* Reduced padding */
            border: 1px solid #444;
            border-radius: 8px;
            font-size: 1em; /* Adjusted font size */
            background-color: #333;
            color: #E0E0E0;
            resize: vertical;
            min-height: 45px; /* Adjusted min height */
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.4); /* Reduced shadow */
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="date"]:focus, /* Added date input type */
        .form-group textarea:focus {
            outline: none;
            border-color: #00ACC1;
            box-shadow: 0 0 0 3px rgba(0, 172, 193, 0.3), inset 0 1px 2px rgba(0, 0, 0, 0.6);
        }
        
        /* Specific styling for date input to ensure consistent appearance */
        .form-group input[type="date"] {
            -webkit-appearance: none; /* Remove default date input styling */
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23E0E0E0" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 24px;
            cursor: pointer;
            padding-right: 40px; /* Make space for the custom icon */
        }


        /* Styling for range inputs (sliders) */
        .form-group input[type="range"] {
            -webkit-appearance: none; /* Remove default styling */
            width: 100%;
            height: 10px; /* Adjust height of the track */
            background: #444; /* Default track color */
            border-radius: 5px;
            outline: none;
            margin: 10px 0; /* Space above/below */
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.4);
            transition: background 0.3s ease;
        }

        /* Thumb (handle) styling for Webkit browsers (Chrome, Safari) */
        .form-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px; /* Size of the thumb */
            height: 25px; /* Size of the thumb */
            border-radius: 50%; /* Make it circular */
            background: #00ACC1; /* Thumb color */
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            margin-top: -8px; /* Center thumb vertically on track */
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }

        /* Thumb (handle) styling for Firefox */
        .form-group input[type="range"]::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #00ACC1;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            border: none; /* Remove default border */
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }

        /* Focus styles for the slider thumb */
        .form-group input[type="range"]:focus::-webkit-slider-thumb {
            box-shadow: 0 0 0 4px rgba(0, 172, 193, 0.4), 0 2px 8px rgba(0, 0, 0, 0.6);
            transform: scale(1.1);
        }
        .form-group input[type="range"]:focus::-moz-range-thumb {
            box-shadow: 0 0 0 4px rgba(0, 172, 193, 0.4), 0 2px 8px rgba(0, 0, 0, 0.6);
            transform: scale(1.1);
        }

        /* Container for slider and its value */
        .slider-group {
            display: flex;
            align-items: center;
            gap: 10px; /* Space between slider and value display */
        }

        .slider-group input[type="range"] {
            flex-grow: 1; /* Make slider take up available space */
            margin: 0; /* Reset margin from general range styling */
        }

        .slider-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #B3E5FC;
            min-width: 30px; /* Ensure space for two digits + /10 */
            text-align: right;
        }

        /* Button Styling - Modern Dynamic */
        button {
            padding: 10px 20px; /* Reduced padding */
            background-color: #00ACC1;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.05em; /* Adjusted font size */
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 172, 193, 0.4); /* Reduced shadow */
        }

        button:hover {
            background-color: #00838F;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.6);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 172, 193, 0.3);
        }

        #clearForm {
            background-color: #FFB300;
            box-shadow: 0 3px 10px rgba(255, 179, 0, 0.4);
        }
        #clearForm:hover {
            background-color: #FB8C00;
            box-shadow: 0 5px 15px rgba(255, 179, 0, 0.6);
        }

        .button-group {
            display: flex;
            gap: 15px; /* Reduced gap */
            justify-content: center; /* Center buttons horizontally */
            margin-top: 10px; /* Add some space above */
        }
        .button-group button {
            flex-grow: 1; /* Allow buttons to grow and fill space */
            max-width: 200px; /* Limit individual button width */
        }

        /* Media Queries for Landscape / Larger Screens */

        /* For screens wider than 576px (e.g., larger phones in landscape, small tablets) */
        @media (min-width: 576px) {
            .container {
                padding: 30px 30px; /* More generous padding */
            }

            nav {
                flex-direction: row; /* Navigation links appear side-by-side */
                gap: 20px; /* More space between links */
            }

            nav a {
                padding: 10px 22px; /* Slightly larger clickable area */
                font-size: 1.05em;
            }

            h1 {
                font-size: 2.8em; /* Slightly larger heading */
                margin-bottom: 30px;
                padding-bottom: 18px;
            }

            .input-section h2, .display-section h2 {
                font-size: 2em; /* Larger section headings */
                margin-bottom: 22px;
                padding-bottom: 12px;
            }

            form {
                gap: 18px;
                padding: 22px;
            }

            .form-group label {
                font-size: 1.05em;
            }
            .form-group input[type="text"],
            .form-group input[type="date"], /* Added date input type */
            .form-group textarea {
                padding: 11px 14px;
                font-size: 1.05em;
                min-height: 48px;
            }
            .button-group {
                gap: 20px;
            }
        }

        /* For screens wider than 768px (e.g., tablets in landscape, desktops) */
        @media (min-width: 768px) {
            body {
                padding: 40px 20px; /* Restore original body padding */
            }

            .container {
                padding: 35px 45px; /* Restore original container padding */
            }

            nav {
                gap: 25px; /* Restore original nav gap */
                margin-bottom: 40px;
                padding-bottom: 20px;
            }

            nav a {
                padding: 12px 25px; /* Restore original nav link padding */
                font-size: 1.1em;
            }

            h1 {
                font-size: 3em; /* Restore original heading size */
                margin-bottom: 35px;
                padding-bottom: 18px;
            }

            .input-section h2, .display-section h2 {
                font-size: 2.2em; /* Restore original section heading size */
                margin-bottom: 25px;
                padding-bottom: 12px;
            }

            form {
                gap: 20px; /* Restore original form gap */
                padding: 25px; /* Restore original form padding */
            }

            .form-group label {
                margin-bottom: 8px; /* Restore original label margin */
                font-size: 1.1em;
            }

            .form-group input[type="text"],
            .form-group input[type="date"], /* Added date input type */
            .form-group textarea {
                padding: 12px 15px; /* Restore original input padding */
                font-size: 1.1em;
                min-height: 50px; /* Restore original min height */
            }

            button {
                padding: 12px 25px; /* Restore original button padding */
                font-size: 1.15em;
            }

            .button-group {
                margin-top: 15px;
            }
            .button-group button {
                max-width: 220px;
            }
        }

        /* Specific adjustment for navigation in very wide screens to prevent stretching */
        @media (min-width: 992px) {
            nav {
                max-width: 800px; /* Limit nav width for aesthetic */
                width: 100%;
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <a href="about.html" class="main-title-link">
            <h1>FriendForge</h1>
        </a>

        <nav>
            <a href="index.html" class="active"><i class="fas fa-plus-circle"></i> Add Friend</a>
            <a href="list.html"><i class="fas fa-users"></i> View Friends List</a>
        </nav>

        <div class="input-section">
            <h2 id="formTitle">Add a New Friend</h2>
            <form id="friendForm">
                <div class="form-group">
                    <label for="name">Friend's Name:</label>
                    <input type="text" id="name" required>
                </div>

                <div class="form-group">
                    <label for="birthday">Birthday:</label>
                    <input type="date" id="birthday">
                </div>

                <div class="form-group">
                    <label for="truthness">Truthfulness:</label>
                    <div class="slider-group">
                        <input type="range" id="truthness" min="0" max="10" value="5">
                        <span id="truthnessValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="angriness">Angriness:</label>
                    <div class="slider-group">
                        <input type="range" id="angriness" min="0" max="10" value="5">
                        <span id="angrinessValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="humor">Humor:</label>
                    <div class="slider-group">
                        <input type="range" id="humor" min="0" max="10" value="5">
                        <span id="humorValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="empathy">Empathy:</label>
                    <div class="slider-group">
                        <input type="range" id="empathy" min="0" max="10" value="5">
                        <span id="empathyValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="optimism">Optimism:</label>
                    <div class="slider-group">
                        <input type="range" id="optimism" min="0" max="10" value="5">
                        <span id="optimismValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="creativity">Creativity:</label>
                    <div class="slider-group">
                        <input type="range" id="creativity" min="0" max="10" value="5">
                        <span id="creativityValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="socialScore">Social Score:</label>
                    <div class="slider-group">
                        <input type="range" id="socialScore" min="0" max="10" value="5">
                        <span id="socialScoreValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="calmness">Calmness:</label>
                    <div class="slider-group">
                        <input type="range" id="calmness" min="0" max="10" value="5">
                        <span id="calmnessValue" class="slider-value">5/10</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="punctuality">Punctuality:</label>
                    <div class="slider-group">
                        <input type="range" id="punctuality" min="0" max="10" value="5">
                        <span id="punctualityValue" class="slider-value">5/10</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="foodPreference">Food Preference:</label>
                    <input type="text" id="foodPreference" placeholder="e.g., Italian, Spicy, Vegan">
                </div>
                <div class="form-group">
                    <label for="hobbies">Hobbies:</label>
                    <textarea id="hobbies" rows="3" placeholder="e.g., Reading, Hiking, Gaming"></textarea>
                </div>
                <div class="form-group">
                    <label for="notes">Notes:</label>
                    <textarea id="notes" rows="3" placeholder="Any additional notes about your friend"></textarea>
                </div>

                <div class="button-group">
                    <button type="submit" id="saveFriendBtn"><i class="fas fa-save"></i> Save Friend</button>
                    <button type="button" id="clearForm"><i class="fas fa-sync-alt"></i> Reset Form</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const friendForm = document.getElementById('friendForm');
            const nameInput = document.getElementById('name');
            const birthdayInput = document.getElementById('birthday'); // New: Birthday input
            const foodPreferenceInput = document.getElementById('foodPreference');
            const hobbiesInput = document.getElementById('hobbies');
            const notesInput = document.getElementById('notes');
            const saveFriendBtn = document.getElementById('saveFriendBtn');
            const clearFormBtn = document.getElementById('clearForm');
            const formTitle = document.getElementById('formTitle');

            // Array of all numerical parameter IDs
            const numericalParams = ['truthness', 'angriness', 'humor', 'empathy', 'optimism', 'creativity', 'socialScore', 'calmness', 'punctuality'];

            // Function to get current friends from Local Storage
            function getFriends() {
                const friendsJSON = localStorage.getItem('friends');
                return friendsJSON ? JSON.parse(friendsJSON) : [];
            }

            // Function to save friends to Local Storage
            function saveFriends(friends) {
                localStorage.setItem('friends', JSON.stringify(friends));
            }

            // Function to update slider value display
            function updateSliderValue(sliderId) {
                const slider = document.getElementById(sliderId);
                const valueSpan = document.getElementById(sliderId + 'Value');
                valueSpan.textContent = `${slider.value}/10`;
            }

            // Attach event listeners to all numerical sliders
            numericalParams.forEach(param => {
                const slider = document.getElementById(param);
                slider.addEventListener('input', () => updateSliderValue(param));
                // Initial update on page load
                updateSliderValue(param);
            });

            // Function to clear the form
            function clearForm() {
                friendForm.reset(); // Resets all form fields to their initial values
                nameInput.value = '';
                birthdayInput.value = ''; // New: Clear birthday input
                foodPreferenceInput.value = '';
                hobbiesInput.value = '';
                notesInput.value = '';
                numericalParams.forEach(param => {
                    const slider = document.getElementById(param);
                    slider.value = 5; // Set sliders back to default 5
                    updateSliderValue(param);
                });
                saveFriendBtn.textContent = 'Save Friend';
                saveFriendBtn.innerHTML = '<i class="fas fa-save"></i> Save Friend'; // Reset icon
                formTitle.textContent = 'Add a New Friend';
                nameInput.readOnly = false; // Make name editable again for new friends
                // Clear the 'edit' parameter from the URL if it exists
                history.pushState({}, '', 'index.html');
                alert("Form cleared! Ready to add a new friend.");
            }

            // Handle form submission
            friendForm.addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent default form submission

                const friendName = nameInput.value.trim();
                if (!friendName) {
                    alert("Friend's name is required!");
                    return;
                }

                let friends = getFriends();
                const isEditMode = nameInput.readOnly;
                let friendToUpdate = null;

                if (isEditMode) {
                    // Find the existing friend by the original name (which is in nameInput.value)
                    friendToUpdate = friends.find(f => f.name === friendName);
                } else {
                    // Check for duplicate name if adding a new friend
                    if (friends.some(f => f.name.toLowerCase() === friendName.toLowerCase())) {
                        alert(`A friend named "${friendName}" already exists! Please use a different name or edit the existing friend from the list.`);
                        return;
                    }
                }

                // Create or update friend object
                const newFriend = {
                    name: friendName,
                    birthday: birthdayInput.value, // New: Add birthday
                    truthness: parseInt(document.getElementById('truthness').value),
                    angriness: parseInt(document.getElementById('angriness').value),
                    humor: parseInt(document.getElementById('humor').value),
                    empathy: parseInt(document.getElementById('empathy').value),
                    optimism: parseInt(document.getElementById('optimism').value),
                    creativity: parseInt(document.getElementById('creativity').value),
                    socialScore: parseInt(document.getElementById('socialScore').value),
                    calmness: parseInt(document.getElementById('calmness').value),
                    punctuality: parseInt(document.getElementById('punctuality').value),
                    foodPreference: foodPreferenceInput.value.trim(),
                    hobbies: hobbiesInput.value.trim(),
                    notes: notesInput.value.trim()
                };

                if (friendToUpdate) {
                    // Update existing friend
                    Object.assign(friendToUpdate, newFriend);
                    alert(`Friend "${newFriend.name}" updated successfully!`);
                } else {
                    // Add new friend
                    friends.push(newFriend);
                    alert(`Friend "${newFriend.name}" added successfully!`);
                }

                saveFriends(friends); // Save updated array to Local Storage
                clearForm(); // Clear the form after saving
            });

            // Handle clear form button click
            clearFormBtn.addEventListener('click', clearForm);

            // Function to load friend data into the form for editing
            function loadFriendForEdit(friendName) {
                const friends = getFriends();
                const friendToEdit = friends.find(f => f.name === friendName);

                if (friendToEdit) {
                    nameInput.value = friendToEdit.name;
                    nameInput.readOnly = true; // Make name read-only during edit
                    formTitle.textContent = `Edit Friend: ${friendToEdit.name}`;
                    saveFriendBtn.textContent = 'Update Friend';
                    saveFriendBtn.innerHTML = '<i class="fas fa-edit"></i> Update Friend'; // Change icon

                    birthdayInput.value = friendToEdit.birthday || ''; // New: Populate birthday field

                    numericalParams.forEach(param => {
                        const slider = document.getElementById(param);
                        slider.value = friendToEdit[param] !== undefined ? friendToEdit[param] : 5; // Use default if undefined
                        updateSliderValue(param);
                    });
                    foodPreferenceInput.value = friendToEdit.foodPreference || '';
                    hobbiesInput.value = friendToEdit.hobbies || '';
                    notesInput.value = friendToEdit.notes || '';
                } else {
                    alert('Friend not found for editing.');
                    clearForm(); // Clear form if friend not found
                }
            }

            // Check URL for 'edit' parameter on page load
            const urlParams = new URLSearchParams(window.location.search);
            const editFriendName = urlParams.get('edit');
            if (editFriendName) {
                loadFriendForEdit(decodeURIComponent(editFriendName));
            }
        });
    </script>
</body>
</html>
